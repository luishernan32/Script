--******************************************************************
--Estados en SOGIT de expedientes de impugnaciones administrativas *
--******************************************************************

SELECT * into #tmp_reg_bienes FROM OPENROWSET( 'Microsoft.ACE.OLEDB.16.0' ,'Excel 12.0; Database=K:\coactivo\reconstr_reg_bien_script\REC_BIENES.xlsx;HDR=YES' ,[lote$]);

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[09:55] Geovanni Rojas Lopez
---version final tabla intermedia
USE [circulemos2]
BEGIN TRAN
CREATE TABLE [dbo].[reconstruccion_registro_bienes_seps](
    [id_reconstruccion_bien] [bigint] IDENTITY(1,1) NOT NULL,
    [numero_juicio] [varchar](20) NOT NULL,
    [numero_referencia] [varchar](500) NOT NULL,
    [numero_oficio] [varchar](20) NOT NULL,
    [valor_bien] [varchar](20) NOT NULL,
    [fecha_registro_bien] [varchar](80) NOT NULL,
    [documento_1] [varchar](500) NOT NULL,
    [procesado] [smallint] NOT NULL,
    [error] [varchar](250) NULL,
    [path_documento_1] [varchar](255) NULL,
    [lote] [varchar](50) NULL,
    [fecha_procesamiento] [datetime] NULL,
    [tipo_identificacion] [varchar](50) NULL,
    [identificacion] [varchar](50) NULL,
    [tipo_cuenta] [varchar](20) NOT NULL,
    [tipo_entidad] [varchar](20) NOT NULL,
    [banco] [varchar](100) NOT NULL,
    [fecha_respuesta] [varchar](20) NOT NULL,
    [num_doc_respuesta] [varchar](100) NOT NULL,
    [tramite_embargo] [varchar](30) NOT NULL
) ON [PRIMARY]
GO
--COMMIT


------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
USE [circulemos2] BEGIN TRAN INSERT INTO [dbo].[reconstruccion_registro_bienes_seps]            ([numero_juicio]            ,[numero_referencia]            ,[numero_oficio]            ,[valor_bien]            ,[fecha_registro_bien]            ,[documento_1]            ,[procesado]            ,[error]            ,[path_documento_1]            ,[lote]            ,[fecha_procesamiento]            ,[tipo_identificacion]            ,[identificacion]            ,[tipo_cuenta]            ,[tipo_entidad]            ,[banco]            ,[fecha_respuesta]            ,[num_doc_respuesta]            ,[tramite_embargo]) select top 5 JUICIO , CUENTA , [OFICIO SOGIT] ,[VALOR] , [FECHA] , [LOTE] , 0 , null , null , [Nº LOTE] , GETDATE() , 'CED' , IDENTIDAD , [TIPO DE CUENTA_ahr/corr] , [TIPO DE ENTIDAD] , [BANCO] , [FECHA RESPUESTA] , [MEMO_BCO] , [TRAMITE EMBARGO] from #tmp_reg_bienes_seps where registros= 'NO REGISTRADO' COMMIT TRAN
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ruta: c2/impulsosCoactivo/2020/2/Coactivo-628741
nombre fichero: 1583766311276.pdf
nombre real: 155067-2018.pdf
 
sudo mkdir /documentos/tmp_app/circulemos_tmp/c2/impulsosCoactivo/2020/2/Coactivo-628741/
 
sudo cp /opt/artefactos/reconstr/prueba_impulso_coactivo.pdf /documentos/tmp_app/circulemos_tmp/c2/impulsosCoactivo/2020/2/Coactivo-628741/155067-2018.pdf
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[dbo].[sp_reconstruir_docs_impugnaciones]
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
[10:51] Alexander Abrahan Aguilar Alvarado
SELECT * into #tmp_reg_impugnaciones

FROM OPENROWSET( 'Microsoft.ACE.OLEDB.16.0'

,'Excel 12.0; Database=K:\impugnaciones\reconstr_impugnaciones.xlsx;HDR=YES' ,[Sheet1$]);
 
select * from #tmp_reg_impugnaciones
 
USE [circulemos2]

CREATE TABLE [dbo].[reconstr_docs_impugnaciones](

    [id_reconstruccion] [bigint] IDENTITY(1,1) NOT NULL,

    [numero_juicio] [varchar](20) NOT NULL,

    [doc_impugnado] [varchar](500) NOT NULL,

    [estado_impugnado] [varchar](20) NOT NULL,

    [doc_auto_inicial] [varchar](500) NOT NULL,

    [estado_auto_inicial] [varchar](20) NOT NULL,

    [doc_cierre_pruebas] [varchar](500) NOT NULL,

	[estado_cierre_puebas] [varchar](20) NOT NULL,

	[doc_resolucion] [varchar](500) NOT NULL,

	[estado_resolucion] [varchar](20) NOT NULL,

    [procesado] [smallint] NOT NULL,

    [error] [varchar](250) NULL,

    [path_doc_impugnado] [varchar](500) NULL,

    [path_doc_auto_inicial] [varchar](500) NULL,

	[path_doc_cierre_pruebas] [varchar](500) NULL,

	[path_doc_fallo] [varchar](500) NULL,

	[path_doc_resolucion] [varchar](500) NULL,

    [fecha_procesamiento] [datetime] NULL

  ) ON [PRIMARY]

GO
 
select * from [reconstr_docs_impugnaciones]
 
 
USE [circulemos2]

begin tran

INSERT INTO [dbo].[reconstr_docs_impugnaciones]

           ([numero_juicio]

           ,[doc_impugnado]

           ,[estado_impugnado]

           ,[doc_auto_inicial]

           ,[estado_auto_inicial]

           ,[doc_cierre_pruebas]

           ,[estado_cierre_puebas]

           ,[doc_resolucion]

           ,[estado_resolucion]

           ,[procesado]

           ,[error]

           ,[path_doc_impugnado]

           ,[path_doc_auto_inicial]

           ,[path_doc_cierre_pruebas]

           ,[path_doc_fallo]

           ,[path_doc_resolucion]

           ,[fecha_procesamiento])

SELECT  [numero juicio],

[documento formulario impugnacion],

[Estado SOGIT formulario impugnacion],

[documento auto inicial],

[Estado SOGIT auto inicial],

[documento cierre de pruebas],

[Estado SOGIT cierre de pruebas],

[documento resolucion],

[Estado SOGIT resolucion],

0,

null,

null,

null,

null,

null,

null,

GETDATE()

FROM  #tmp_reg_impugnaciones

where [numero juicio]='14667-2023'
 
commit tran
 
 
select * from [dbo].[reconstr_docs_impugnaciones]
 
 
use circulemos2

select pr.numero_proceso, year(pr.fecha_inicio) año, pr.fecha_inicio, tp.fecha_inicio fecha_estado  ,tp.id_estado_proceso, ep.nombre estado_proceso , tdp.nombre tipo_documento ,

dpl.id_proceso, dpl.nombre_plantilla, upe.login, dpl.codigo_plantilla,dp.*, dd.*

from proceso pr

join trazabilidad_proceso tp on pr.id_proceso = tp.id_proceso

join documento_proceso dp on tp.id_trazabilidad_proceso = dp.id_trazabilidad_proceso

join tipo_documento_proceso tdp on  dp.id_tipo_documento_proceso = tdp.id_tipo_documento_proceso

join [documentos].[dbo].[documento] dd on dd.consecutivo_documento = dp.numero_documento

join [documentos].[dbo].[plantilla]   dpl on dpl.id_plantilla = dd.id_plantilla

join usuario_persona upe on upe.id_usuario = tp.id_usuario

join estado_proceso ep on tp.id_estado_proceso = ep.id_estado_proceso

where pr.id_tipo_proceso = 1

and tp.id_estado_proceso in (1)

--and pr.numero_proceso = '15058'

and year(pr.fecha_inicio) =2024

order by tp.id_trazabilidad_proceso;
 
select * from gestor_docs.dbo.data_documento

where codigo_documento = 261671134
[10:51] Alexander Abrahan Aguilar Alvarado


[desarrollo@gyqpruapl02v3 ~]$ cd /documentos/c2/Proceso_Impugnacion/2023/11/1/

-bash: cd: /documentos/c2/Proceso_Impugnacion/2023/11/1/: No existe el fichero o el directorio

[desarrollo@gyqpruapl02v3 ~]$ cd /documentos/c2/Proceso_Impugnacion/2023/11

-bash: cd: /documentos/c2/Proceso_Impugnacion/2023/11: No existe el fichero o el directorio

[desarrollo@gyqpruapl02v3 ~]$ cd /documentos/c2/Proceso_Impugnacion/2023

-bash: cd: /documentos/c2/Proceso_Impugnacion/2023: No existe el fichero o el directorio

[desarrollo@gyqpruapl02v3 ~]$ cd /documentos/c2/Proceso_Impugnacion/

[desarrollo@gyqpruapl02v3 Proceso_Impugnacion]$ sudo mkdir /documentos/c2/Proceso_Impugnacion/

[sudo] password for desarrollo:

sudo: a password is required

[desarrollo@gyqpruapl02v3 Proceso_Impugnacion]$ sudo mkdir /documentos/c2/Proceso_Impugnacion/2023

[sudo] password for desarrollo:

[desarrollo@gyqpruapl02v3 Proceso_Impugnacion]$ sudo mkdir /documentos/c2/Proceso_Impugnacion/2023/11

[desarrollo@gyqpruapl02v3 Proceso_Impugnacion]$ sudo mkdir /documentos/c2/Proceso_Impugnacion/2023/11/1

[desarrollo@gyqpruapl02v3 Proceso_Impugnacion]$ cd /documentos/c2/Proceso_Impugnacion/2023/11/1/

[desarrollo@gyqpruapl02v3 1]$ sudo cp "/opt/artefactos/reconstr_docs_impugs/FORMULARIO DE IMPUGNACION 15977-2023.pdf" /documentos/c2/Proceso_Impugnacion/2023/11/1/20002140_v1.pdf

[desarrollo@gyqpruapl02v3 1]$ pwd

/documentos/c2/Proceso_Impugnacion/2023/11/1

[desarrollo@gyqpruapl02v3 1]$ ls

20002140_v1.pdf

[desarrollo@gyqpruapl02v3 1]$

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------